
\begin{abstract}
В работе исследуется проблема наглядного представления результатов компьютерного моделирования процесса сейсморазведки.
Предлагается методика построения синтетических сейсмограмм на основе расчётных данных.
В работе рассмотрен, как 2D случай, так и 3D.
Разработана программа Seismograph, производящая полуавтоматическое построение наглядных графиков.
Приведены примеры применения предложенной методики для получения значимых интерпретационных результатов.
Описан формат хранения данных численных расчётов, эффективный, как на этапе сохранения, так и на этапе постобработки.
Отдельно рассмотрены примеры алгоритма сохранения данных в случае однопроцессорного и многопроцессорного расчёта.
\kwr Математическое моделирование, сеточно-характеристический численный метод, моделирование процесса сейсморазведки, наглядное представление результатов, интерпретация геофизических данных.
\end{abstract}
 
%Примерная структура статьи.

\section{Введение}

Описание актуальности, геофизики - сейсморазведка.

Для регистрации сигнала-отклика на практике широко применяются специальные приборы - сейсмоприёмники.
Они позволяют регистрировать смещение земной поверхности в точке их установки как функцию времени.
Одной из видов классификаций является деление по типу регистрации: однокомпонентные и многокомпонентные датчики.
При однокомпонентной регистрации, как правило записывается лишь вертикальная составляющая смещения.
При многокомпонентной регистрации также фиксируются проекции смещения на север и восток.
Кроме того, в зависимости от физического принципа, на котором основан датчик, возможна регистрация смещения, скорости или ускорения.     
%Введение.

\section{Компьютерное моделирование сейсмических процессов в геологических средах}

Для описания динамического поведения геологических сред используется явное выделение всех неоднородностей на этапе построения расчётной сетки совместно с сеточно-характеристическим численным методо [ссылка на Холодова].
Определяющая система уравнений в случае линейно-упругого тела имеет вид:
\begin{equation}\label{eq:elasticsystem}
\rho\cdot\dot{\nu_{i}}=\nabla_{j}\sigma_{ij}
\end{equation}
\begin{equation}\label{eq:guk}
\dot{\sigma_{ij}}=\lambda(\dot{\epsilon_{11}}+\dot{\epsilon_{22}}+\dot{\epsilon_{33}})\delta_{ij}+2\mu\dot{\epsilon_{ij}}
\end{equation}
\begin{equation}\label{eq:derivationeps}
\dot{\epsilon_{ij}}=\frac{1}{2}(\nabla_{i}\nu_{j}+\nabla_{j}\nu_{i})
\end{equation}

Таким образом, результатом численного расчёта являются значения всех компонент тензора напряжений и всех компонент скорости смещения в каждом узле сетки в последовательные моменты времени.
Для
%Первый раздел.

\begin{figure}[h] \centering
\includegraphics[height=0.15\textheight]{fig1}

\caption{Пример вставки рисунка}
\end{figure}

\section{Формат сохранения данных численного расчёта}

Одной из особенностей компьютерного моделирования на расчётной сетке (особенно задач в 3D постановке) явлется огромный объём обрабатываемой информации.
Например, расчётная сетка из 1 миллиона узлов с хранимой в них информацией и использованием типа float для упругой задачи в 2D занимает ХХХ Mb, и XXX Mb в 3D.
При переходе к типу double эти цифры удваиваются.
При среднем числе шагов по времени порядка 1 000 получается огромная величина.
Поскольку операция обращения к жёсткому диску является наиболее затратной в данном случае, необходимость сохранения результатом может наложить существенные ограничения на скорость расчётов.
Кроме проблем с быстродействием и хранением, возникают также и проблемы постобработки результатом.
Отметим, что в полевом эксперименте единственной наблюдаемой величиной, как правило, является сейсмограмма.
В связи с этим, представляется перспективным построение синтетических сейсмограмм по результатам численного расчёта.
Для этого достаточно сохранения всех компонент скорости смещения в заранее фиксированных узлах сетки - местах расстановки сейсмодатчиков.
Было решено использовать формат CSV (Comma-Separated Values) с сохранением числовых значений в ASCII формате. Хотя данное представление увеличивает объём памяти, необходимый для представления числа (по сравнению с бинарным представлением), оно позволяет эффективно представить наличие заголовка таблиц. Стандартная структура файла имеет следующий вид:

Time;Vx;Vy;Vz;

0;0;0;0

0.01;0;0;0

0.02;1.45e-2;1e-2;1.2e-5
%Второй раздел.

\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.5\linewidth]{fig1} \\ а)}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.5\linewidth]{fig1} \\ б)}
\end{minipage}
\caption{Пример вставки двух рисунков в одну строчку с общей подписью}
\end{figure}
\section{Структура программы Seismograph и её возможности}

Была разработана программа Seismograph, позволяющая в полуавтоматическом режиме проводить построение синтетических сейсмограмм по результатам компьютерного моделирования.
Для обеспечения кроссплатформенности совместно с высокой скоростью работы и простотой поддержки кода в качестве языка разработки был выбран Python.
Для реализации GUI (Graphic User Interface) была выбрана библиотека Tkinter.
Использование командной Open Source утилиты Gnuplot позволило с минимальными усилиями реализовать отрисовку сейсмограммы по подготовленным входным данным и сохранение её в формате PNG (Portable Network Graphics) для дальнейшего использования в презентациях, публикациях и т.д.
Таким образом, разработанная программа успешно работает, как на системах семейства Windows, так и Unix.

Одной из задач, стоящей перед автором на момент начала работы над проектом, являлось создание простого и интуитивного интерфейса.
Одновременно с этим хотелось предоставить пользователю возможность настройки параметров отображения под конкретную задачу.
При реализации пользовательского интерфейса был избран минималистический путь.
Программа содержит всего одно окно и запуск построения сейсмограммы контролируется одной кнопкой Draw.
Настройка всех параметров вынесена в один столбец в левой части экрана, а остальная часть рабочего пространства отведена под отображение построенного графика (см. рис. \ref{pic:mainwindow}).

\begin{figure}[h] \centering
\includegraphics[height=0.3\textheight]{seismograph}
\caption{Главное окно программы Seismograph}
\label{pic:mainwindow}
\end{figure}

Опишем подробнее влияние значения каждого параметра на вид сейсмограммы.
Во-первых, доступен выбор "Draw Quantity" (отображаемой величины) = {Vx, Vy, Vz (3D), Vabs} - любой компоненты скорости смещения или его модуля.
Для наглядного изображения знакопеременных значений (отдельных компонент вектора скорости) реализованы настойки "Paint Level", "Down Limit", "Up Limit", "Paint below/above".
Последнее поле может принимать значения "below" и "above", определяющие, закрашивать ли отрицательную или положительную часть каждой сейсмотрассы, соответственно.
При этом нулевой уровень закраски может быть изменён задание значения из диапазона [-1, 1] в поле "Paint Level".
Значение none - означает выбор значения по-умолчанию, равного 0 для данной настройки.
Поддерживается также задание верхнего ("Up Level") и нижнего ("Down Level") порода отображения сейсмотрассы, что может быть использовано для одновременного отображения на сейсмограмме волн с большой разницей в амплитуде.
По-умолчанию пределы не устанавливаются и в случае, если показания приёмника превышают расстояние между ближайшими прямыми, происходит наложение данных, которое обычно затрудняет их интерпретацию.

Часто бывает удобным проводить детальный анализ определённой части (ограниченной по номерам сейсмоприёмников и диапазону времени записи) всех сохранённых данных.
Возможность ограничения отображаемого временного диапазона реализована параметрами "From Time Number" и "Until Time Number".
В них задаются номера отсчётов датчиков.
Кроме целых значений поле также может принимать строковые значения "start" и "end", означающие начало записи и конец записи, соответственно.
Умелое использование данных параметров позволяет с высокой точностью выделить интересующие интерпретатора сигналы-отклики.
Предусмотрена также возможность пространственного прореживания информации.
Кроме построения всей сейсмотрассы по расположенным через равные промежутки вдоль прямой линии сейсмодатчикам возможен выбор: первого датчика в серии ("Start Receiver"), количества датчиков в серии ("Receivers Number") и промежутка пропускаемых датчиков ("Every K Receiver").

Поля "Distance" и "Amplification" позволяют изменять расстояние между сейсмотрассами с ближайших датчиков и усиление каждой сейсмотрассы.
Они могут быть использованы для получения более наглядной волновой картины путём надлюжащего масштабирования.
Поле "Time Tics" задаёт шаг шкалы по оси ординат, что может быть использовано, например, для повышения ручного пикирования первых вступлений.
Поле "Gap (m)" позволяет задать в имени сохраняемого файла информацию о расстоянии между ближайшими сейсмотрассами в полученной сейсмограмме, что может быть полезно при обработке множества данных в широком диапазоне параметров.

Процедура отрисовки сейсмограммы по заданным параметрам состоит из следующих шагов: подготовка входных данных для gnuplot (создание временных файлов), вызов gnuplot и сохранение изображения в формате PNG в каталоге Results с соответствующим именем файла, отображение построенной сейсмограммы в главном окне программы.
\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.5\linewidth]{fig1}}
\caption{Пример вставки двух рисунков в одну строчку~--- первый рисунок}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.5\linewidth]{fig1}}
\caption{Два рисунка в одну строчку~--- второй рисунок}
\end{minipage}
\end{figure}

\section{Использование Seismograph для интерпретации данных компьютерного моделирования}

Программа Seismograph с момента разработки уже продемонстрировала высокую востребованность.
Она была использована в научной группе, в которой автор работает над  кандидатской диссертацией, для визуализации результатов численного моделирования задач сейсморазведки в 2D постановке на неструктурных треугольных сетках, а также в 3D постановке на структурных криволинейных и неструктурных тетраэдральных сетках.

Например, в статье [Муратов Численное моделирование ... (кластера) ... макротрещин] интерпретацией синтетических сейсмограмм, построенных по данным численного 2D моделирования, было установлено, что
\begin{enumerate}
\item Система (кластер) однородно ориентированных субвертикальных макротрещин формирует при падении на неё плоской волны продольных колебаний многофазные фронты рассеянных продольных и обменных волн, образованных интерференцией соответствующих дифрагированных волн.
\item В условиях субгоризонтальных границ, возбуждения плоского фронта продольных колебаний и флюидонасущенного продуктивного трещиноватого пласта выявлена возможность при записи X-компоненты регистрации фронта рассеянных поперечных колебаний как основного отклика от системы (кластера) субвертикальных макротрещин.
\item Структура волновых откликов от кластера характеризуется наличием интенсивныз многофазных горищонтальных фронтов (в пределах ширины кластера) на врмениеприхода продольной дифрагированной волны при регистрации вертикальной компоненты и на премени прихода обменной дифрагированноый волны при регистрации горизонтальной компоненты.
Вне зон этих фронтов регистрируются на порядок более слабые фрагменты гипербол дифрагированных волн от краевых макротрещин кластера.
\item Отмечается резкое различие в характере отклика в зависимости от насыщения системы (кластера) макротрещин жидкостью (водой или нефтью) или газом.
В первом случае они наилучшим образом проявляются при регистрации горизонтальной (X) компоненты записи в виде фронта рассеянных обменных волн.
Во втором - при регистрации вертикальной (Z) компоненты ввиде многофазного фронта рассеянных продольных волн.
\item Многофазная структура фронта рассеянных волн саязана с межтрещинными отражениями, подпитывающими отклик дополнительной энергией.
\item Особенно значительное преимущество в выделении систем флюидонасыщенных макротрещин отмечается при  регистрации горизонтальной (X) компоненты в условиях слоистого разреза с субгоризонтальными границами, когда фронт рассеянных волн регистрируется почти без помех за счет того, что обменные отражения от этих границ имеют или нулевую, или очень низкую интенсивность.
\item По ширине горизонтального участка фронтов рассеянных продольных и обменных волн можно судить о местоположении и ширине кластера макротрещин.
\item При увеличении расстояния между трещинами (с 75 до 300 м) отмечается двухкратное понижение частоты колебаний в многофазном фронте рассеянных волн.
\end{enumerate}

В работе [Муратов Расчет волновых откликов от систем субвертикальных ... с использованием сеточно-характеристи] анализ результатов 2D моделирования сейсмического отклика от кластера флюидонасыщенных трещин с использованием синтетических сейсмограмм позволил выявить эмпирические зависимости для определения вертикальной и горизонтальной протяжённости кластера, а также расстояния между соседними трещинами.
Предложенная ПРОДОЛЖЕНИЕ СЛЕДУЕТ 

%И т.д.

\section{Вывод}
В статье предложена методика наглядного представления результатов численных расчётов на основе построения синтетических сейсмограмм в полуавтоматическом режиме. Описана разработанная на языке Python программа, позволяющая производить визуализацию, как в случае 2D расчёта, так и 3D. Приведены примеры использования Seismograph на этапе интерпретации результатов моделирования для получения практически значимых результатов.
%Вывод.

\begin{thebibliography}{99}

\bibitem{s1} \textit{Левянт В.\,Б., Петров И.\,Б., Муратов М.\,В.} Численное моделирование волновых откликов от системы (кластера) субвертикальных макротрещин // Технологии сейсморазведки.~--- 2012.~--- №~1.~--- С.~5--21.

\bibitem{s2} \textit{Diallo M.\,S., Kulesh M., Holschneider M., Sherbaum F., Adler F.} Characterization of polarization attributes of seismic waves using continuous wavelet transforms // Geophysics.~--- 2006.~--- V.~71, N.~3.~--- P.~ V67--V77.

\bibitem{s3}  \textit{Лайонс Р.}  Цифровая обработка сигналов.~--- М.: Бином, 2006.~--- С.~361--369.


\end{thebibliography}

\begin{flushright}
 \textit{Поступила в редакцию ???}
\end{flushright}



